<div>
  <%= @movie.movie_name %>
  <% movieinfo = JSON.parse((Tmdb::Search.movie( @movie.movie_name)).to_json) %>
  <p><%= image_tag 'https://image.tmdb.org/t/p/w1280' + movieinfo['table']['results'][0]['table']['poster_path'],class: "card-img" %></p>
</div>


<h3>いいね件数: <%= @movie.likes.count %></h3>
<% if current_user.already_liked?(@movie) %>
  <%= button_to 'いいねを取り消す', movie_like_path(@movie), method: :delete %>
<% else %>
  <%= button_to 'いいね', movie_likes_path(@movie) %>
<% end %>



<div class="comments">
  <h4>＜goodコメント一覧＞</h4>
  <% @good_comments.each do |comment| %>
    <p>
      <%# <%= comment.genre.name %>
      <strong><%= comment.user.nickname %>：</strong>
      <%= comment.text %>
    </p>
  <% end %>
</div>
<div class="comments">
  <h4>＜badコメント一覧＞</h4>
  <% @bad_comments.each do |comment| %>
    <p>
      <%# <%= comment.genre.name %> 
      <strong><%= comment.user.nickname %>：</strong>
      <%= comment.text %>
    </p>
  <% end %>
</div>
<div class="comments">
  <h4>＜その他コメント一覧＞</h4>
  <% @other_comments.each do |comment| %>
    <p>
      <%# <%= comment.genre.name %> 
      <strong><%= comment.user.nickname %>：</strong>
      <%= comment.text %>
    </p>
  <% end %>
</div>







<div class="container">
    <% if user_signed_in? %>
      <%= form_with(model: [@movie, @comment], local: true) do |form| %>
        <%= form.text_area :text, placeholder: "コメントする", rows: "2" %>
        <%= form.collection_select(:genre_id, Genre.all, :id, :name, {}, {class:"genre-select"}) %>
        <%= form.submit "SEND" %>
      <% end %>
    <% else %>
      <strong><p>※※※ コメントの投稿には新規登録/ログインが必要です ※※※</p></strong>
    <% end %>
 </div>

<%= link_to 'トップページへ戻る', root_path %>